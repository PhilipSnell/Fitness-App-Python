{% extends "trainerInterface/nav.html" %}
{% load static %}
{% block content %}
    <style>
    .groupContainer {
        position: relative;


    }
    .groupRow {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(19%, 1fr));
        grid-gap: 1rem;
        width: calc(70vw);
        border-spacing: 15px; /*Optional*/
        padding-bottom: calc(5vh);

    }
    .groupBox {
        border-radius: 10px;
        {#width: 200%;#}
        height: 0;
        padding-bottom: 100%;
        display: flex;
        position: relative;
        background-color: rgba(0, 0, 0, 0.3);
        justify-content: center;     /* added for centered text */
        align-items: center;
    }


    .groupContent {
        position: relative;
        top: 10px;
        left: 0;
        height: 100%;
        width: 100%;
        display: flex;
        margin: auto;
        justify-content: center;     /* added for centered text */
        align-items: center;         /* added for centered text */
    }
    .addGroupContent {
        cursor: pointer;
        background-color: rgba(0, 0, 0, 0.3);
        position: relative;
        top: calc(5.5vw);
        width: calc(5vw);
        height: calc(5vw);
        display: flex;
        justify-content: center;     /* added for centered text */
        align-items: center;         /* added for centered text */
        border-radius: 10px;
        font-size: 36px;
        text-align: center;
        margin: auto;
    }
    div p {
      top: 47%;
      transform: translateY(-50%);
      position: relative;
    }
    .bg-modal{
        left:   0;
        top:    0;
        bottom: 0;
        width: 100%;
        height: calc(100vh - 45px);
        background: rgba(0, 0, 0, 0.7);
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .modal-content{
        position: relative;
        display:flex;
        flex-direction: column;
        overflow-y: scroll;
        overflow-x: hidden;
        padding-top: calc(1vw);
        margin-left: auto;
        margin-right: auto;
        width: calc(21vw);
        min-height: calc(21vw);
        max-height: calc(25vw);
        background-color: whitesmoke;
        border-radius: 5px;
        align-items: center;
        {#justify-content: center;#}

    }
    .close_addentry{
        background-color: rgba(0, 0, 0, 0);
        cursor: pointer;
        position: absolute;
        top: -4px;
        left: 10px;
        font-size: 32px;
        -ms-transform: rotate(45deg); /* IE 9 */
        -webkit-transform: rotate(45deg); /* Chrome, Safari, Opera */
        transform: rotate(45deg);
    }

    .submitContainer{
        background-color: #0b2e13;
        align-items: center;
        display: inline;
    }
    .submit_add_form{
        position: relative;
        margin-right: auto;
        left: 31%;
        width: 38%;
        margin-top: 0.5vw;
    }
    #groupname{
        position: relative;
        left: 20%;
        width: 60%;
        text-align: center;
    }
    .addgroup{
        padding-bottom: 1vw;
    }
    .add_field_button{
        position: relative;
        border-color: rgba(0, 0, 0, 0.3);
        background-color: rgba(0, 0, 0, 0.3);
        color: #0e0e0e;
        width: 2vw;

    }
    .addfieldbutton{
        position: relative;
        border-color: rgba(0, 0, 0, 0.3);
        background-color: rgba(0, 0, 0, 0.3);
        color: #0e0e0e;
        width: 2vw;
        left: 8vw;
        margin-top: 0.5vw;
    }
    .clear_field_button{

        border-color: rgba(0, 0, 0, 0.3);
        background-color: rgba(0, 0, 0, 0.3);
        color: #0e0e0e;
        width: 2vw;

    }
    .clearfieldbutton{
        position: relative;
        border-color: rgba(0, 0, 0, 0.3);
        background-color: rgba(0, 0, 0, 0.3);
        color: #0e0e0e;
        width: 2vw;
        left: 8vw;
        margin-top: 0.5vw;
    }
    .fields{
        position: relative;
        width: 18vw;
    }
    #fieldname{
        width: 35%;
    }
    .btn-group-xs > .btn, .btn-xs {
      padding: .1rem .4rem;
      font-size: .875rem;
      line-height: .5;
      border-radius: .2rem;

    }
    </style>
    <div class="groupContainer">
        <div class="groupRow">
            {% for group in groups %}
                <div class="groupBox">
                    <div class="groupContent">
                        {{ group.name }}
                    </div>
                </div>
{#                {% if forloop.counter|divisibleby:4 %}#}
{#                    </div>#}
{#                    <div class="groupRow">#}
{#                {% endif %}#}
            {% endfor %}
            <div class="groupBox">
                <div class="addGroupContent" onclick="toggleAddEntry()"><p>+</p>
                </div>
            </div>
        </div>
    </div>
<div class="bg-modal" id ="add-entry-modal"style="display: none;">
    <div class="modal-content">
        <div class="close_addentry">+</div>

        <form id = "add-group-form" class = "add-group-form" method="post">
            <div class="addgroup">
                {{ addGroupForm }}
            </div>
            <div class="fields" id="fields">
                <div class="field" id="field-0">
                    <div style="display: inline; justify-content: center">
                        {{ addFieldForm }}
                    </div>
                    <div class="btn-group"  style="display: inline">
                        <select class="btn btn-secondary btn-xs dropdown-toggle" name="fieldSelect" id="fieldSelect">
                            <option value="text">text</option>
                            <option value="number">number</option>
                        </select>
                    </div>
                    <div class="pull-right" style="display: inline">
                        <button type="button" onClick="removeDiv(this)" class="delete-field btn btn-danger btn-sm">&times</button>
                    </div>
                </div>
            </div>
            <div class="addfieldbutton"><button class="add_field_button btn btn-sm btn-secondary">+</button></div>
            <input  class="submit_add_form" type="submit" name="submit" value="submit">
        </form>

    </div>
</div>

<script src="{% static '/assets/js/jquery.min.js' %}"></script>
<script src="/static/assets/js/popper.js"></script>
<script src="{% static '/assets/js/jquery.bootstrap.modal.forms.js' %}"></script>
<script src="{% static '/bootstrap/js/bootstrap.js' %}"></script>
<script type="text/javascript">
        var x = document.getElementById("add-entry-modal");
       x.style.display = "none";
        var addFieldCount = 0;
        function toggleAddEntry() {
            var x = document.getElementById("add-entry-modal");
            if (x.style.display === "none" || x.style.display) {
              x.style.display = "flex";
            } else {
              x.style.display = "none";
            }
        }
        $('.close_addentry').on('click', function(e) {
          var x = document.getElementById("add-entry-modal");
          x.style.display = "none";
        });
        function removeDiv(elem){
            $(elem).parent('div').parent('div').remove();
        }

        $('.bg-modal').on('click', function(e) {
          if (e.target !== this)
            return;
          var x = document.getElementById("add-entry-modal");
          x.style.display = "none";
        });
        $('.add_field_button').on('click', function(e) {
          e.preventDefault();
          var x = document.getElementById('fields');
          var div = document.getElementById('field-0');
          var newDiv = div.cloneNode(true);
          addFieldCount = addFieldCount + 1;
          newDiv.id = "field-"+addFieldCount;
          x.appendChild(newDiv)

        });
        $('.add-group-form').on('submit', function(e){
         e.preventDefault();

           $.ajax({
                type : "POST",
                url: "{% url 'add_group' %}",
                data: {

                 name : $('#groupname').val(),
                 fieldname: $('#fieldname').val(),
                 textOrInt: $('#fieldSelect').val(),
                 csrfmiddlewaretoken: '{{ csrf_token }}',
                 dataType: "json",
                },
                success: function(data){
                    location.reload();
                },
                failure: function() {
                }
            });

           {#window.location.reload();#}
           {#var x = document.getElementById("add-entry-modal");#}
           {#x.style.display = "none";#}
        });
    </script>
{% endblock content%}
